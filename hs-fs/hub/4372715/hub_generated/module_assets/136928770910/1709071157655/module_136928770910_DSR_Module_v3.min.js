var module_136928770910=function(){let initialDiv=document.querySelector("#initialDiv"),successDiv=document.querySelector("#successDiv"),dataDiv=(document.querySelector("#doNotSellSuccessDiv"),document.querySelector("#doNotSellFailDiv"),document.querySelector("#dataDiv")),deleteDiv=document.querySelector("#deleteDiv"),tableBody=document.querySelector("#tableBody"),agreeButton=document.querySelector("#agreeButton"),doNotSellAgreeButton=document.querySelector("#doNotSellAgreeButton"),deleteButton=document.querySelector("#deleteButton"),deleteButtonContainer=document.querySelector("#deleteButtonContainer"),deleteSuccessContainer=document.querySelector("#deleteSuccessContainer"),deleteFailContainer=document.querySelector("#deleteFailContainer"),hasSubmitted=!1;function getWidgetId(elementId){const recaptchaBoxes=document.querySelectorAll(".g-recaptcha"),targetBox=document.querySelector(`#${elementId}`);for(let i=0;i<recaptchaBoxes.length;i++)if(recaptchaBoxes[i].id===targetBox.id)return i}const deleteRecaptcha=getWidgetId("deleteRecaptcha");window.recaptchaCallback=result=>{agreeButton.disabled=!1,hasSubmitted&&(deleteButton.disabled=!1)},window.recaptchaExpiredCallback=result=>{agreeButton.disabled=!0,deleteButton.disabled=!0},agreeButton.addEventListener("click",(async e=>{const dsrData=await async function(){const recaptchatoken=grecaptcha.getResponse();try{const req=await fetch(`https://cj.dotomi.com/data-subject-request?recaptchatoken=${recaptchatoken}`,{credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}});return console.log(req),console.log(req.body),await req.json()}catch(err){return console.log(err),{error:"Request failed"}}}();console.log(dsrData),0===dsrData.length?dataDiv.innerHTML="<p>No personal data found.</p>":dsrData.error?dataDiv.innerHTML="<p>There was an error processing your request.</p>":dsrData.forEach((record=>{const row=document.createElement("tr"),{eventTimestamp:eventTimestamp,advertiserName:advertiserName,requestUrl:requestUrl,refUrl:refUrl,ip:ip,recordType:recordType}=record;let timestamp=new Date(parseInt(eventTimestamp)).toLocaleDateString("en-US");row.innerHTML=`\n        <td>${timestamp}</td>\n        <td>${recordType}</td>\n        <td>${advertiserName}</td>\n        <td>${requestUrl}</td>\n        <td>${refUrl}</td>\n        <td>${ip}</td>\n    `,tableBody.appendChild(row)})),initialDiv.classList.replace("d-flex","d-none"),successDiv.classList.replace("d-none","d-flex"),deleteDiv.classList.replace("d-none","d-block"),hasSubmitted=!0})),deleteButton.addEventListener("click",(async e=>{const deleteResponse=await async function(){const recaptchatoken=grecaptcha.getResponse(deleteRecaptcha);try{const req=await fetch(`https://cj.dotomi.com/data-delete-request?recaptchatoken=${recaptchatoken}`,{credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}});return console.log(req),console.log(req.status),req.status}catch(err){return console.log(err),{error:"Request failed"}}}();console.log(deleteResponse),200===deleteResponse?(deleteButtonContainer.classList.add("d-none"),deleteSuccessContainer.classList.replace("d-none","d-flex")):(deleteButtonContainer.classList.add("d-none"),deleteFailContainer.classList.replace("d-none","d-flex"))})),window.recaptchaDoNotSellCallback=result=>{doNotSellAgreeButton.disabled=!1},window.recaptchaDoNotSellExpiredCallback=result=>{doNotSellAgreeButton.disabled=!0};const DoNotSellRecaptcha=getWidgetId("DoNotSellRecaptcha");doNotSellAgreeButton.addEventListener("click",(async e=>{const recaptchaToken=grecaptcha.getResponse(DoNotSellRecaptcha);try{if((await fetch(`https://cj.dotomi.com/do-not-sell-my-data-request?recaptchatoken=${recaptchaToken}`,{credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}})).ok){console.log("Do Not Sell request submitted successfully");document.querySelector("#doNotSellSuccessDiv").classList.replace("d-none","d-flex")}else console.error("Do Not Sell request failed"),handleDoNotSellFailure()}catch(err){console.error("An error occurred during the Do Not Sell request",err),handleDoNotSellFailure()}}))}();